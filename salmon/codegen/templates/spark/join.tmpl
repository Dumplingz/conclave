lCol = [{{{LEFT_COL}}}]
rCol = [{{{RIGHT_COL}}}]

l = {{{LEFT_PARENT}}} \
    .map(lambda x: (tuple([x[i] for i in lCol]), \
        tuple([x[i] for i in range(len(x)) if i not in set(lCol)]))) \
    .cache()

r = {{{RIGHT_PARENT}}} \
    .map(lambda x: (tuple([x[i] for i in rCol]), \
        tuple([x[i] for i in range(len(x)) if i not in set(rCol)]))) \
    .cache()

z = l.zip(r)

{{{OUTREL}}} = z \
    .map(lambda x: (x[0][0], x[0][1], x[1][1]) if x[0][0] == x[1][0] else []) \
    .filter(lambda x: x != []) \
    .map(lambda x: numpy.hstack(numpy.array(x)).tolist()) \
    .cache()